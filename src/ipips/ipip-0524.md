---
title: "IPIP-0524: Remove IPLD Data Model translations from Gateways"
date: 2025-11-27
ipip: proposal
editors:
  - name: Alex Potsides
    github: achingbrain
    url: https://achingbrain.net
    affiliation:
        name: Shipyard
        url: https://ipshipyard.com
relatedIssues:
  - https://github.com/ipfs/gateway-conformance/issues/200
order: 524
tags: ['ipips']
---

## Summary

Make IPFS HTTP Gateway responses easier to reason about by not requiring IPLD
Data Model translations

## Motivation

When sending an [Accept](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Accept)
header or [format](https://specs.ipfs.tech/http-gateways/path-gateway/#format-request-query-parameter)
query parameter to specify the response format of a request, the IPFS HTTP
Gateway specs [allow translation](https://specs.ipfs.tech/http-gateways/path-gateway/#accept-request-header)
of the requested content into the [IPLD Data Model](https://ipld.io/docs/data-model/).

This adds significant complexity to HTTP Gateway implementations, since they
need to be able to translate between arbitrary data types and handle all the
various failure states.

The conversions are also lossy due to differences in supported data types across
different formats so lack general-purpose utility and are ultimately something
that could be done on an interested client if required.

## Detailed design

An IPFS HTTP Gateway should make an attempt to verify that requested data can be
represented in the desired response format (e.g. it should attempt to parse the
block as JSON string or CBOR data when the relevant formats are requested,
though in the case of CBOR it does not need to support all [tags](https://www.iana.org/assignments/cbor-tags/cbor-tags.xhtml)
encountered in the block).

If the block was loaded successfully but cannot be represented in the requested
format, the server should return a [406](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Status/406).

This would be the outcome if, for example a DAG-JSON block was requested with
the `application/cbor` format.

Where a human-readable rendering of the data is desired, the `text/html` format
can be requested. This would allow browsing DAG-PB data, for example.

A [400](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Status/400)
may be returned if the request was invalid (for example an unsupported format
was requested).

A [500](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Status/500)
may be returned in other circumstances.

## Design rationale

Simplifying the HTTP Gateway spec to remove these format translations and the
additional logic required makes it more straightforward to create new
implementations, and makes the returned data more transparent and so easier to
understand since the data is not modified to fit the output format.

Clients that wish to translate between different data formats may request raw
blocks and do the translation themselves.

### User benefit

HTTP Gateways will be simpler to use having fewer options and they will be
encouraged to adapt their clients for their individual use-cases where more
advanced functionality is required.

### Compatibility

This is a breaking change. Data will no longer be translated between different
formats by the server and that logic will shift to interested clients.

## Test fixtures

Implementers can run the [gateway-conformance](https://github.com/ipfs/gateway-conformance/)
test suite.

### Copyright

Copyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).
